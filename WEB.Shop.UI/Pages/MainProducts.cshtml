@page
@model MainProductsModel
@{
    ViewData["Title"] = "Home page";
}

    <div class="container-fluid">
        <div class="row">
            <div class="col-lg=3">
                <form method="post">
                    <div>
                        <div class="input-group md-form form-sm form-2 pl-0">
                            <input class="form-control my-0 py-1 amber-border" asp-for="@Model.SearchString" type="text" placeholder="Nazwa produktu..." aria-label="Search">
                            <div class="input-group-append">
                                <span class="input-group-text amber lighten-3" id="basic-text1">
                                    <i class="fas fa-search text-grey"
                                       aria-hidden="true"></i>
                                </span>
                            </div>
                        </div>

                        <div>
                            <select name="SelectedShop">
                                <option value="Wszystkie">Wszystkie Sklepy</option>

                                @foreach (var shop in Model.Shops)
                                {
                                    <option value="@shop">@shop</option>
                                }
                            </select>

                        </div>
                        <div>
                            @*<button type="submit">Szukaj</button>*@
                            <button asp-page-handler="Search">Szukaj</button>
                            <button asp-page-handler="ShowAll">Pokaż Wszystko</button>
                        </div>
                    </div>
                </form>

                <form method="post">


                </form>

                <div>
                    <p>Kryteria Wyszukiwania: </p>
                    <p>Wyszukiwana fraza - @(String.IsNullOrEmpty(Model.SearchString) ? "Brak" : Model.SearchString)</p>
                    <p>Wyszukiwany sklep - @Model.SelectedShop</p>
                    <p>Wyszukane Produkty - @Model.Count</p>
                    <p>Obecna Strona - @Model.CurrentPage</p>
                    <p>Wszystkie Strony - @(Model.TotalPages == 0 ? 1 : Model.TotalPages)</p>
                </div>

                <div class="block">
                    <nav class="pagination is-rounded">
                        <ul class="pagination-list">
                            @if (Model.ShowFirst)
                            {
                                <li>
                                    <a asp-page="/MainProducts" asp-route-CurrentPage="1" class="pagination-link">Początek</a>
                                </li>
                            }

                            @if (Model.ShowPrevious)
                            {
                                <li>
                                    <a asp-page="/MainProducts" asp-route-CurrentPage="@(Model.CurrentPage -1)" class="pagination-link">Poprzednia Strona</a>
                                </li>
                            }

                            @if (Model.ShowNext)
                            {
                                <li>
                                    <a asp-page="/MainProducts" asp-route-CurrentPage="@(Model.CurrentPage + 1)" class="pagination-link">Następna Strona</a>
                                </li>
                            }

                            @if (Model.ShowLast)
                            {
                                <li>
                                    <a asp-page="/MainProducts" asp-route-CurrentPage="@(Model.TotalPages)" class="pagination-link">Koniec</a>
                                </li>
                            }
                        </ul>
                    </nav>
                </div>
            </div>
            <div class="col-lg-9">

                <div class="row">

                    @foreach (var p in Model.Products)
                    {
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card h-100">
                                <a asp-page="Product" asp-route-name="@p.Name.Replace(" ","-")">

                                    <div class="card-body">
                                        @{
                                            string cssClass = "";
                                            string message = "";

                                            if (!string.IsNullOrEmpty(p.Description) && p.Description.Contains(" !PROMOCJA! "))
                                            {
                                                cssClass = "is-warning";
                                                message = " PROMOCJA! ";
                                            }
                                        }
                                        @if (!string.IsNullOrEmpty(p.Description))
                                        {
                                            <div class="card-text @cssClass">
                                                @message
                                            </div>
                                        }
                                        <div class="card-title">
                                            @p.Name

                                        </div>

                                        <div class="card-subtitle mb-2 text-muted">
                                            @p.Value
                                        </div>

                                        <div class="card-title">
                                            @p.Description
                                        </div>

                                        <div class="card-title">
                                            @p.Seller
                                        </div>
                                    </div>
                                </a>

                                <div class="card-footer text-center">
                                    <small class="text-muted">
                                        @p.TimeStamp.ToString("yyyy/MM/dd HH:mm")
                                    </small>

                                </div>

                            </div>
                        </div>
                    }
                </div>
            </div>

        </div>
    </div>